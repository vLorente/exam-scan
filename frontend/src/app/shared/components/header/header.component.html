<header class="header" role="banner" [attr.aria-label]="'Encabezado de ' + subtitle()" [class.scrolled]="isScrolled()">
  <div class="header-container">
    <button class="header-brand"
            (click)="navigateToDashboard()"
            aria-label="Ir al dashboard"
            [attr.aria-describedby]="'brand-desc'">
      <div class="brand-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
          <rect x="9" y="9" width="6" height="6"/>
          <path d="m9 1 1 1v6a1 1 0 01-1 1H3a1 1 0 01-1-1V2a1 1 0 011-1h6"/>
        </svg>
      </div>
      <div class="brand-text">
        <h1 class="brand-title">{{ title() }}</h1>
        <span class="brand-subtitle">{{ subtitle() }}</span>
      </div>
    </button>
    <span id="brand-desc" class="sr-only">Navegar al panel de control principal</span>

    @if (user(); as currentUser) {
      <nav class="header-nav" aria-label="Navegación principal">
        <ul class="nav-list" role="list">
          @for (navItem of visibleNavigationItems(); track navItem.route) {
            <li>
              <button class="nav-item"
                      (click)="navigateToRoute(navItem.route)"
                      [attr.aria-label]="navItem.ariaLabel"
                      [attr.aria-describedby]="navItem.route.substring(1) + '-desc'">
                <app-document-icon [size]="'18'" [ariaHidden]="true" />
                <span class="nav-text">{{ navItem.label }}</span>
              </button>
              <span [id]="navItem.route.substring(1) + '-desc'" class="sr-only">{{ navItem.description }}</span>
            </li>
          }
        </ul>
      </nav>

      <div class="header-user">
        <div class="user-welcome">
          <div class="user-role">
            <div class="role-badge" [class]="'role-' + currentUser.role"
                 [attr.aria-label]="'Rol: ' + getRoleLabel(currentUser.role)"
                 [attr.title]="getRoleLabel(currentUser.role)">
              {{ getRoleLetter(currentUser.role) }}
            </div>
          </div>
          <div class="user-info">
            <span class="welcome-message">Bienvenido,</span>
            <span class="user-name">{{ currentUser.fullName }}</span>
          </div>
        </div>
        <button
          class="logout-button"
          (click)="onLogout()"
          aria-label="Cerrar sesión"
          [attr.aria-describedby]="'logout-desc'">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
            <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/>
            <polyline points="16,17 21,12 16,7"/>
            <line x1="21" y1="12" x2="9" y2="12"/>
          </svg>
          <span class="logout-text">Cerrar Sesión</span>
        </button>
        <span id="logout-desc" class="sr-only">Cierra tu sesión actual y regresa a la página de inicio</span>
      </div>
    }
  </div>
</header>
